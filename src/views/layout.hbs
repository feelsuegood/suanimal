<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{pageTitle}}</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9"
      crossorigin="anonymous"
    />
     {{! Mapbox CDN  }}
    <script
      src="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.js"
    ></script>
    <link
      href="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css"
      rel="stylesheet"
    />
    <!-- D3.js ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤. -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link rel="stylesheet" href="/stylesheets/style.css" />
    <style>
      .bd-placeholder-img { font-size: 1.125rem; text-anchor: middle;
      -webkit-user-select: none; -moz-user-select: none; user-select: none; }
      @media (min-width: 768px) { .bd-placeholder-img-lg { font-size: 3.5rem; }
      } 
      #map { width: 100%; height: 400px}
      #chart-container { width: 100%; height: 400px; }
    </style>

  </head>
  <body class="d-flex flex-column h-100">
    <style>
      .mapboxgl-popup { max-width: 400px; font: 12px/20px 'Helvetica Neue',
      Arial, Helvetica, sans-serif; }
    </style>
    <header>
      <nav
        class="navbar navbar-expand-md fixed-top navbar-light bg-warning px-5 py-3"
      >
        <div class="container-fluid">
          <div class="custom-navbar__logo">
            <a class="navbar-brand" href="/">ğŸ¦§ SUANIMAL ğŸ¦</a>
          </div>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarCollapse"
            aria-controls="navbarCollapse"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div
            class="collapse navbar-collapse custom-navbar__item"
            id="navbarCollapse"
          >
            <ul class="navbar-nav me-auto mb-2 mb-md-0">
              <li class="nav-item">
                <a class="nav-link" aria-current="page" href="/">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/about">About</a>
              </li>
              <li class="nav-item">
              </li>
            </ul>
            <form
              class="d-flex"
              form
              action="/animal"
              method="get"
              id="navbar-search__form"
            >
              <input
                name="name"
                class="form-control"
                type="text"
                placeholder="eg. koala"
                aria-label="Search"
              />
              <button type="submit" class="search-button">
                <i
                  class="fa-solid fa-magnifying-glass fa-xs"
                  style="color: #ffffff;"
                ></i></button>
            </form>
          </div>
        </div>
      </nav>
    </header>
    <main class="flex-shrink-0">
      <div class="custom-contents px-5">
        {{{body}}}
      </div>
      <!-- FOOTER -->
      <footer class="footer custom-footer pt-3 pb-1 px-4">
        <div class="container-fluid">
          <span class="text-muted">&copy; {{year}} Suanimal</span>

          <p class="float-end"><a href="#">Back to top
              <i
                class="fa-solid fa-up-long"
                style="color: #4f4f4f;"
              ></i></a></p>
        </div>
      </footer>
    </main>
    {{! bootstrap: css }}
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
      crossorigin="anonymous"
    ></script>
    {{! fontawesome: icon }}
    <script
      src="https://kit.fontawesome.com/90b0d86629.js"
      crossorigin="anonymous"
    ></script>
{{!-- * ì§€ë„ js ì½”ë“œ --}}
<script>
mapboxgl.accessToken =
  "{{MAPBOX_API_KEY}}";
const map = new mapboxgl.Map({
  container: "map",
  // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
  style: "mapbox://styles/mapbox/streets-v12",
  // {{!-- ë°°ì—´ ì²« ë²ˆì§¸ í•­ëª© ë„£ê¸° --}}
  center: [-77.04, 38.907],
  // zoom: 1,
  zoom: 11,
});

map.on("load", () => {
  map.addSource("places", {
    // This GeoJSON contains features that include an "icon"
    // property. The value of the "icon" property corresponds
    // to an image in the Mapbox Streets style's sprite.
    type: "geojson",
    data: {
      type: "FeatureCollection",
      features: [
        {
          type: "Feature",
          properties: {
            // {{!-- ì—¬ê¸°ì„œë¶€í„° #each ì“°ê¸° --}}
            description:
              '<button class="btn btn-primary" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasBottom" aria-controls="offcanvasBottom">Toggle bottom offcanvas</button>',
          },
          geometry: {
            type: "Point",
            // {{!-- #each ë‘ë²ˆì§¸ --}}
            coordinates: [-77.038659, 38.931567],
          },
        },
        {
          type: "Feature",
          properties: {
            description:
              '<strong>Mad Men Season Five Finale Watch Party</strong><p>Head to Lounge 201 (201 Massachusetts Avenue NE) Sunday for a <a href="http://madmens5finale.eventbrite.com/" target="_blank" title="Opens in a new window">Mad Men Season Five Finale Watch Party</a>, complete with 60s costume contest, Mad Men trivia, and retro food and drink. 8:00-11:00 p.m. $10 general admission, $20 admission and two hour open bar.</p>',
          },
          geometry: {
            type: "Point",
            coordinates: [-77.003168, 38.894651],
          },
        },
        {
          type: "Feature",
          properties: {
            description:
              '<strong>Truckeroo</strong><p><a href="http://www.truckeroodc.com/www/" target="_blank">Truckeroo</a> brings dozens of food trucks, live music, and games to half and M Street SE (across from Navy Yard Metro Station) today from 11:00 a.m. to 11:00 p.m.</p>',
            icon: "music",
          },
          geometry: {
            type: "Point",
            coordinates: [-77.007481, 38.876516],
          },
        },
      ],
    },
  });
  // Add a layer showing the places.
  map.addLayer({
    id: "places",
    'type': 'circle',
'source': 'places',
'paint': {
'circle-color': '#4264fb',
'circle-radius': 6,
'circle-stroke-width': 2,
'circle-stroke-color': '#ffffff'
}
  });

  // When a click event occurs on a feature in the places layer, open a popup at the
  // location of the feature, with description HTML from its properties.
  map.on("click", "places", (e) => {
    // Copy coordinates array.
    const coordinates = e.features[0].geometry.coordinates.slice();
    const description = e.features[0].properties.description;

    // Ensure that if the map is zoomed out such that multiple
    // copies of the feature are visible, the popup appears
    // over the copy being pointed to.
    while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
      coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
    }

    new mapboxgl.Popup().setLngLat(coordinates).setHTML(description).addTo(map);
  });

  // Change the cursor to a pointer when the mouse is over the places layer.
  map.on("mouseenter", "places", () => {
    map.getCanvas().style.cursor = "pointer";
  });

  // Change it back to a pointer when it leaves.
  map.on("mouseleave", "places", () => {
    map.getCanvas().style.cursor = "";
  });
});

</script>
{{!-- *ê·¸ë˜í”„ ìë°”ìŠ¤í¬ë¦½íŠ¸ --}}
<script>// ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
const data = 
  [
    {
      "month": 1,
      "tavg": -3.8,
      "tmin": -6.3,
      "tmax": -1.3,
      "prcp": 49,
      "wspd": null,
      "pres": 1011.3,
      "tsun": 2400
    },
    {
      "month": 2,
      "tavg": -3.4,
      "tmin": -6.3,
      "tmax": -0.4,
      "prcp": 36,
      "wspd": null,
      "pres": 1014.2,
      "tsun": 4560
    },
    {
      "month": 3,
      "tavg": 0.6,
      "tmin": -2.8,
      "tmax": 4,
      "prcp": 46,
      "wspd": null,
      "pres": 1011.6,
      "tsun": 7560
    },
    {
      "month": 4,
      "tavg": 5.4,
      "tmin": 1.3,
      "tmax": 9.6,
      "prcp": 42,
      "wspd": null,
      "pres": 1012.6,
      "tsun": 10680
    },
    {
      "month": 5,
      "tavg": 11.6,
      "tmin": 7,
      "tmax": 16.3,
      "prcp": 52,
      "wspd": null,
      "pres": 1014.1,
      "tsun": 13200
    },
    {
      "month": 6,
      "tavg": 16,
      "tmin": 11.1,
      "tmax": 20.9,
      "prcp": 65,
      "wspd": null,
      "pres": 1011.5,
      "tsun": 15000
    },
    {
      "month": 7,
      "tavg": 17.4,
      "tmin": 12.7,
      "tmax": 22,
      "prcp": 84,
      "wspd": null,
      "pres": 1010.6,
      "tsun": 14760
    },
    {
      "month": 8,
      "tavg": 16.2,
      "tmin": 11.8,
      "tmax": 20.6,
      "prcp": 90,
      "wspd": null,
      "pres": 1011.2,
      "tsun": 12960
    },
    {
      "month": 9,
      "tavg": 11.8,
      "tmin": 8,
      "tmax": 15.6,
      "prcp": 90,
      "wspd": null,
      "pres": 1010.8,
      "tsun": 8640
    },
    {
      "month": 10,
      "tavg": 7,
      "tmin": 4.3,
      "tmax": 9.8,
      "prcp": 84,
      "wspd": null,
      "pres": 1011.3,
      "tsun": 5160
    },
    {
      "month": 11,
      "tavg": 1.4,
      "tmin": -1,
      "tmax": 3.7,
      "prcp": 75,
      "wspd": null,
      "pres": 1008.8,
      "tsun": 3060
    },
    {
      "month": 12,
      "tavg": -2.6,
      "tmin": -5.1,
      "tmax": 0,
      "prcp": 56,
      "wspd": null,
      "pres": 1009.2,
      "tsun": 2100
    }
  ];

// SVG ë„ˆë¹„ì™€ ë†’ì´ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
const width = 600;
const height = 400;
const xAxisLabel = "month"; // xì¶• ë ˆì´ë¸”
const yAxisLabel = "Â°C"; // yì¶• ë ˆì´ë¸”


// D3.jsë¥¼ ì‚¬ìš©í•˜ì—¬ SVG ìš”ì†Œë¥¼ ì„ íƒí•˜ê³  í¬ê¸°ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
const svg = d3.select("#chart")
  .attr("width", width)
  .attr("height", height);

// xì¶• ìŠ¤ì¼€ì¼ì„ ì„¤ì •í•©ë‹ˆë‹¤.
const xScale = d3.scaleLinear()
  .domain([1, 12]) // ì›”ë³„ ë°ì´í„°ê°€ 1ë¶€í„° 12ê¹Œì§€ ìˆìŒ
  .range([50, width - 50]); // xì¶• ë²”ìœ„

// yì¶• ìŠ¤ì¼€ì¼ì„ ì„¤ì •í•©ë‹ˆë‹¤.
const yScale = d3.scaleLinear()
  .domain([-10, 30]) // ì˜ˆì‹œ ë²”ìœ„, ì‹¤ì œ ë°ì´í„°ì— ë§ê²Œ ì¡°ì •í•´ì•¼ í•©ë‹ˆë‹¤.
  .range([height - 50, 50]); // yì¶• ë²”ìœ„

  // xì¶• ìƒì„±
svg.append("g")
  .attr("class", "x-axis")
  .attr("transform", `translate(0, ${height - 50})`) // xì¶•ì˜ ìœ„ì¹˜ ì¡°ì •
  .call(d3.axisBottom(xScale))
  .append("text")
  .attr("x", width / 2)
  .attr("y", 40) // xì¶• ë ˆì´ë¸”ì˜ ìœ„ì¹˜ ì¡°ì •
  .attr("text-anchor", "middle")
  .text(xAxisLabel);

// yì¶• ìƒì„±
svg.append("g")
  .attr("class", "y-axis")
  .attr("transform", `translate(50, 0)`) // yì¶•ì˜ ìœ„ì¹˜ ì¡°ì •
  .call(d3.axisLeft(yScale))
  .append("text")
  .attr("x", -height / 2)
  .attr("y", -30) // yì¶• ë ˆì´ë¸”ì˜ ìœ„ì¹˜ ì¡°ì •
  .attr("transform", "rotate(-90)") // yì¶• ë ˆì´ë¸”ì„ 90ë„ íšŒì „
  .attr("text-anchor", "middle")
  .text(yAxisLabel);

  // xì¶• ë ˆì´ë¸” ì¶”ê°€
svg.append("text")
  .attr("x", width / 2)
  .attr("y", height - 10) // xì¶• ë ˆì´ë¸”ì˜ ìœ„ì¹˜ ì¡°ì •
  .attr("text-anchor", "middle")
  .text(xAxisLabel);

// yì¶• ë ˆì´ë¸” ì¶”ê°€
svg.append("text")
  .attr("x", -height / 2)
  .attr("y", 20) // yì¶• ë ˆì´ë¸”ì˜ ìœ„ì¹˜ ì¡°ì •
  .attr("transform", "rotate(-90)") // yì¶• ë ˆì´ë¸”ì„ 90ë„ íšŒì „
  .attr("text-anchor", "middle")
  .text(yAxisLabel);



// ì„  ìƒì„± í•¨ìˆ˜ë¥¼ ë§Œë“­ë‹ˆë‹¤.
const line = d3.line()
  .x((d) => xScale(d.month))
  .y((d) => yScale(d.tavg));

// ì„  ê·¸ë˜í”„ë¥¼ ê·¸ë¦½ë‹ˆë‹¤.
svg.append("path")
  .datum(data)
  .attr("fill", "none")
  .attr("stroke", "steelblue")
  .attr("stroke-width", 2)
  .attr("d", line(data));
</script>
    {{! start address with inside of public folder}}
    {{! <script
      src="javascripts/index.js"
    ></script> }}
  </body>
</html>